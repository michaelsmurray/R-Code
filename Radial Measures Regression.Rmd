---
title: "Delhi Regression Tuning 11.12.15"
author: "Michael Murray"
date: "November 12, 2015"
output: word_document
---

```{r, echo=FALSE}
setwd("~/Spatial Segmentation/India")
delhi <- read.csv("delhi.csv")
library(geosphere)
```

### Standard Regression with a dummy variable for large ( > 500 units) buildings
#### Large buildings appear to be a large amenity
```{r}
head(delhi$large.building)
delhi.lm.poi <- lm(hp ~ rooms + property + Connaught.Place + Nehru.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial +
                     parking + petrol + tourist + amusement + bus +
                     community + highered + library + parkinglot +
                     train + police + animal + business + commuterrail +
                     hospital + performingarts + school + park + large.building, data = delhi)

summary(delhi.lm.poi)
```


TO DO
### Leave in Laxmi, take out Nehru
#### Still a disamenity, will explore further
```{r}
delhi.lm.poi <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train + police + animal + business + commuterrail + hospital + performingarts + school + park + large.building, data = delhi)

summary(delhi.lm.poi)
```

#### Dummy's for distance to "commuterrail", "train", "bus", "petrol"
```{r}
delhi$commuterrail.dist.half <- ifelse(delhi$commuterrail <= 500, 1, 0)

delhi$commuterrail.dist.quarter <- ifelse(delhi$commuterrail <= 250, 1, 0)

delhi$train.dist.half <- ifelse(delhi$train <= 500, 1, 0)

delhi$train.dist.quart <- ifelse(delhi$train <= 250, 1, 0)

delhi$bus.dist.half <- ifelse(delhi$bus <= 500, 1, 0)

delhi$bus.dist.quart <- ifelse(delhi$bus <= 250, 1, 0)

delhi$petrol.dist.half <- ifelse(delhi$petrol <= 500, 1, 0)

delhi$petrol.dist.quart <- ifelse(delhi$petrol <= 250, 1, 0)
```

### Indira Ghandi airport
```{r}
delhi$airport.lat <- 28.5561624
delhi$airport.lon <- 77.0999578

p1 <- matrix(c(delhi$Longitude,delhi$Latitude),nrow=length(delhi$Longitude),ncol=2)
p2 <- matrix(c(delhi$airport.lon,delhi$airport.lat),nrow=length(delhi$Longitude),ncol=2)

Indira.Ghandi <- distHaversine(p1,p2)

delhi <- data.frame(delhi, Indira.Ghandi)
```

### remove airport and performing arts

### distance to park
```{r}
delhi$park.dist.km <- ifelse(delhi$park <= 1000, 1, 0)

delhi$park.dist.1to2km <- ifelse(delhi$park >1000 && delhi$park<2000, 1, 0)
```

```{r}
cor(delhi$parking,delhi$parkinglot)
```

# ```{r}
# delhi.lm.poi2 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train + police + business + commuterrail + hospital + school + park + large.building, Indira.Ghandi, data = delhi)
# 
# summary(delhi.lm.poi2)
# ```

### Change park measure
#### makes park a significant amenity
# ```{r}
# delhi.lm.poi3 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train + police + business + commuterrail + hospital + school + park.dist.km + large.building + Indira.Ghandi, data = delhi)
# 
# summary(delhi.lm.poi3)
# ```
### Test park.dist.1to2km
# ```{r}
# delhi.lm.poi4 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train + police + business + commuterrail + hospital + school + park.dist.km + park.dist.1to2km+ large.building + Indira.Ghandi, data = delhi)
# 
# summary(delhi.lm.poi4)
# ```

### Test commuterrail specifics
#### dist.half works best, significant amenity
# ```{r}
# delhi.lm.poi5 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train + police + business + commuterrail.dist.half + hospital + school + park.dist.km + park.dist.1to2km+ large.building + Indira.Ghandi, data = delhi)
# 
# summary(delhi.lm.poi5)
# ```

### Test train specifics
#### dist.half works best, significant amenity
# ```{r}
# delhi.lm.poi6 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus +community + highered + library + parkinglot + train.dist.half + police + business + commuterrail.dist.half + hospital + school + park.dist.km+ large.building + Indira.Ghandi, data = delhi)
# 
# summary(delhi.lm.poi6)
#```

### Test bus specifics
#### dist.half works best, significant amenity
#### petrol fixed as a result
```{r}
delhi.lm.poi7 <- lm(hp ~ rooms + property + Connaught.Place + Laxmi.Nagar +airport + bar + cemetery + golf + industrial + parking + petrol + tourist + amusement + bus.dist.half +community + highered + library + parkinglot + train.dist.half + police + business + commuterrail.dist.half + hospital + school + park.dist.km+ large.building + Indira.Ghandi, data = delhi)

summary(delhi.lm.poi7)
```

