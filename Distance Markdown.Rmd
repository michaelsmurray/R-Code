---
title: "Measuring Distance"
author: "Michael Murray"
date: "September 28, 2015"
output: word_document
---

#### To conduct hedonic regression for use in Spatial Segmentation, residences and points of interest (POI) are transformed into a matrix of distances. Columns of this matrix represent each individual POI while rows represent individual residences. This necessitates a conversation method for calulating these distances which is outlined in this document. 

```{r, echo = FALSE}
library(ggmap)
library(geosphere)

setwd("~/Spatial Segmentation/Actual Data")
delhi <- read.csv("delhi_rent2.csv")
```

## Point to Point Measurement
### This demonstration calculates distance only to the central business district (CBD) of New Delhi. Connaught Place is used as the CBD and its center is listed at 
## 28.632778, 77.219722

## Map residences to check for outlying points
```{r}
myMap <- get_map(location = "Delhi, India", source = "stamen", maptype="watercolor", crop = FALSE)

ggmap(myMap) + geom_point(aes(x=Longitude,y=Latitude),data=delhi,
                          alpha=0.05,color="darkblue")
```

### Using Connaught Place as the CDB, add its coordinates to our delhi dataset
```{r}
delhi$CBD.lat <- 28.632778
delhi$CBD.lon <- 77.219722
```

### Calulate distance using Haversine great circle distance, also known as 'as the crow flies'
```{r}
p1 <- matrix(c(delhi$Longitude,delhi$Latitude),nrow=length(delhi$Longitude),ncol=2)
p2 <- matrix(c(delhi$CBD.lon,delhi$CBD.lat),nrow=length(delhi$Longitude),ncol=2)

CBD <- distHaversine(p1,p2)
``` 

### Construct distance matrix
```{r}
df <- data.frame(delhi$hp, CBD)
head(df)
```

## Point to Shape
### Measuring the distance to a shape such as a shoreline is more difficult than point to point. However, a number of packages writen for R provide this functionality out of the box. One of these is the "rgeos" package which contains the gDistance() function

### gDistance takes as arguments a shapefile, using the function readShapeLines() to read it into R, and a lon-lat point 










